generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_PRISMA_URL") // Uses Vercel Postgres connection string
  directUrl = env("POSTGRES_URL_NON_POOLING") // Uses direct connection for migrations
}

model Room {
  id           String    @id @default(cuid())
  code         String    @unique // Public 4-6 char code
  status       String    // "LOBBY", "ACTIVE", "FINISHED"
  phase        String?   // "DAY", "NIGHT", "GAME_OVER"
  dayNumber    Int       @default(0)
  
  // Settings
  minPlayers   Int       @default(6)
  maxPlayers   Int       @default(15)
  revealOnElim Boolean   @default(true)
  dayDuration  Int       @default(120) // Seconds
  nightDuration Int      @default(60)

  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  players      Player[]
}

model Player {
  id           String    @id @default(cuid())
  name         String
  avatar       String?
  role         String?   // "MAFIA", "CIVILIAN", "DOCTOR", "DETECTIVE"
  isAlive      Boolean   @default(true)
  
  // Actions
  voteTarget   String?   // ID of player this user is voting to lynch
  actionTarget String?   // ID of player this user is targeting at night
  
  roomId       String
  room         Room      @relation(fields: [roomId], references: [id])
}
